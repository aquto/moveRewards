/*! move-rewards 2020-04-01 */

!function(e,n){var i={body:n.body,video:X("video"),eligibleElement:X("eligibleWrapper"),errorElement:X("errorWrapper"),ineligibleMsgElement:X("ineligibleMessage"),icon:X("icon"),phoneEntry:X("phoneEntryWrapper"),eligibleUI:X("eligible"),ineligibleUI:X("ineligible"),timer:X("timer"),phoneCheck:X("phoneCheck"),input:n.querySelector("#phone"),videoTimer:X("videoTimer"),currentTimeTxt:X("currentTime"),durationTxt:X("duration"),loadingWrapper:X("loadingWrapper"),loading:X("loading"),phoneEntryTitle:X("phoneEntryTitle"),thanksMsg:X("thanksMsg"),processingText:X("processingText"),phoneEntrySubTitle:X("phoneEntrySubTitle"),phoneEntrySubmitBtn:X("phoneEntrySubmitBtn"),rewardTextEligible:X("rewardTextEligible"),continueBtn:X("continueBtn"),eligibleBtn:X("eligibleBtn"),ineligibleTitle:X("ineligibleTitle"),ineligibleSubTitle:X("ineligibleSubTitle"),ineligibleBtn:X("ineligibleBtn"),errorMsg:X("errorMsg")};let t=X("videoOverlay"),o=X("loadingOverlay");const r=J("cid"),l=J("vu"),c="1"===J("d"),a=J("b"),s="1"===J("dc"),u=J("psid"),d=J("ch"),p=J("co")&&J("co").split(","),g=J("l")&&J("l").split(","),m=[0,25,50,75,95],b=J("trimp"),h=J("trclk"),v={start:J("trvst"),25:J("trv25"),50:J("trv50"),75:J("trv75"),95:J("trv95"),complete:J("trvc")},f="-",y={impression:"impression",autoIdentify:"click",phoneEntry:"phonenumber",videoStart:"videostart",videoEnd:"videoend",videoError:"videoerror"},T=parseScriptQuery(document.getElementById("aquto-api")),E=T.be||"app.aquto.com",L=(T.ow,{mx:{minLen:12,maxLen:12,countryCode:"52"},cl:{minLen:11,maxLen:11,countryCode:"56"},ar:{minLen:10,maxLen:14,countryCode:"549"},co:{minLen:12,maxLen:12,countryCode:"57"},pe:{minLen:11,maxLen:11,countryCode:"51"},br:{minLen:13,maxLen:13,countryCode:"55"}}),k={52:"mx",56:"cl",549:"ar",57:"co",51:"pe",55:"br"},x=["mx","cl","ar","co","pe","br"],M=x,w=intersect(p,x)||M,C=w[0],I=["es","pt","en"],S=I,B=intersect(g,I)||S,U=(navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.userLanguage||navigator.language||navigator.browserLanguage||S[0]).substring(0,2),H=B.find(function(e){return U===e})||B[0],W=translations[H];let P,D,N=!1,q=!1,O=!1;const R=videojs("player",{controls:!s,autoplay:!1,preload:!0,nativeControlsForTouch:!1,inactivityTimeout:0,disableVideoPlayPauseClick:!0,poster:a||"../assets/images/watch-this-eligible.png",sources:[{type:"video/mp4",src:"../assets/videos/placeholder.mp4"}],plugins:{vastClient:{adTagUrl:l,preferredTech:"html5",adsEnabled:!0}}});R.on("play",function(){K("play"),q&&Z(i.video),s&&(i.currentTimeTxt.innerHTML=ee(Math.floor(this.currentTime()))),N||(N=!0,ne(y.videoStart),ce("custom video start pixel",v.start))}),R.on("timeupdate",function(e){if(!q){const e=Math.floor(this.currentTime()/this.duration()*100);if(K("update",e),n=this.currentTime(),t=this.duration(),s&&(i.currentTimeTxt.innerHTML=ee(Math.floor(n)),i.durationTxt.innerHTML=ee(Math.floor(t))),D.clickId){const n=m;let i=null;do{e>=(i=n.length>0?n[0]:101)&&(n.shift(),ie(D.clickId,i))}while(e>=i)}}var n,t}),R.on("vast.adError",function(e){Z(i.ineligibleMsgElement),K("vast.adError",e.error),Z(i.eligibleElement),Z(i.video),Y(i.errorElement),q=!0}),R.on("vast.contentEnd",function(){K("vast.contentEnd"),Z(i.video),q?ne(y.videoError):(ne(y.videoEnd),ce("custom video end pixel",v.complete),(new Image).src=v.complete,O?(Y(i.eligibleElement),aquto.complete({campaignId:r,callback:function(e){K("complete"),e?(Z(i.loadingWrapper),Y(i.eligibleElement),i.icon.classList.remove("fa-check-circle","fa-times-circle"),e.eligible?(K("complete success"),i.icon.classList.add("fa-check-circle"),_("success"),i.processingText.innerHTML=e.rewardText):(K("complete failure"),i.icon.classList.toggle("fa-times-circle"),_("fail"),i.processingText.innerHTML=W.ineligibleMsg)):(K("complete invalid response"),i.icon.classList.toggle("fa-times-circle"),_("fail"),i.processingText.innerHTML=W.completeFailMsg)}})):(K("not eligible"),Z(i.video),Y(i.ineligibleMsgElement)))}),c&&(R.on("click",function(e){K("click",e)}),R.on("vast.adClick",function(e){K("vast.adClick",e)}));const j={allowDropdown:!0,formatOnDisplay:!0,initialCountry:C,nationalMode:!1,onlyCountries:w,separateDialCode:!0},A=e.intlTelInput(i.input,j);let F=5;const V=function(){event&&event.preventDefault();const e=A.getNumber().replace("+","");Y(o),o.addEventListener("click",function(e){e.stopPropagation&&e.stopPropagation(),null!==e.cancelBubble&&(e.cancelBubble=!0)});const n=re(d,e?y.phoneEntry:y.autoIdentify);K("checkPhoneNumber",{phone:e,publisherSiteUuid:u,callChannel:n}),e||ce("custom bannerClick pixel",h),aquto.checkAppEligibility({campaignId:r,phoneNumber:e,publisherSiteUuid:u,channel:n,callback:function(n){K("checkAppEligibilityResponse",n),Z(o),n?(Z(t),s&&Y(i.videoTimer),D=Object.assign({},n),n.identified?(n.eligible?(O=!0,e?(K("phone entered eligible"),F=5,Y(i.eligibleUI),Z(i.phoneCheck),i.rewardTextEligible.innerHTML=n.rewardText):(K("identified & eligible"),Z(i.loadingWrapper),Y(i.video),R.play())):(O=!1,e?(K("phone entered ineligible"),F=5,Y(i.ineligibleUI),Z(i.phoneCheck)):(K("identified + ineligible"),F=10,Z(i.loadingWrapper),Z(i.video),Y(i.phoneEntry),Z(i.phoneCheck),Y(i.ineligibleUI),Y(i.timer),i.timer.innerHTML=oe(F),$())),e&&(Y(i.timer),i.timer.innerHTML=oe(F),$())):e?(K("phone entered unidentified"),F=10,O=!1,Y(i.ineligibleUI),Z(i.phoneCheck),Y(i.timer),i.timer.innerHTML=oe(F),$()):(K("unidentified"),O=!1,Z(i.loadingWrapper),Z(i.video),Y(i.phoneEntry))):(K("error.checkAppEligibility"),Z(i.loadingWrapper),Z(i.video),Y(i.errorElement))}})},Q=function(e){event&&event.preventDefault(),P&&(clearTimeout(P),P=null,K("countdown stopped")),Z(i.phoneEntry),Z(i.eligibleElement),Y(i.video),0!==e&&R.play()},z=function(){const e=i.timer;F>0?(F--,e.innerHTML=oe(F),$()):Q(!0)};function G(){const e=A.getNumber().replace("+",""),n=function(){const e=A.getNumber().replace("+",""),n=Object.entries(k);for(let i=0;i<n.length;i++)if(e.substring(0,n[i][0].length)===n[i][0])return n[i][1]}(),t=n&&e.length>=L[n].minLen&&e.length<=L[n].maxLen;i.phoneEntrySubmitBtn.disabled=!t}function J(n){let i,t,o=e.location.search.substring(1).split("&");for(t=0;t<o.length;t++)if((i=o[t].split("="))[0]===n)return void 0===i[1]||decodeURIComponent(i[1])}function K(e,n){c&&console.log(e,n)}function X(e){return n.getElementById(e)}function Y(e){e&&e.classList.remove("hide")}function Z(e){e&&e.classList.add("hide")}function $(){P=setTimeout("countDown()",1e3)}function _(e){"success"===e&&(i.body.classList.remove("fail"),i.body.classList.add(e)),"fail"===e&&(i.body.classList.remove("success"),i.body.classList.add(e))}function ee(e){return Math.floor(e/60).toString().padStart(2,"0")+":"+(e%60).toString().padStart(2,"0")}function ne(e){te("datarewards/pixel","?campaignId="+encodeURIComponent(r)+"&publisherSiteUuid="+encodeURIComponent(le(u))+"&channel="+encodeURIComponent(re(d,e)),"tracking url")}function ie(e,n){te("event/videoview","?clickId="+le(e)+"&percentageViewed="+n,"video tracking url"),ce("video tracking url",v[n])}function te(e,n,i){const t="//"+E+"/api/campaign/"+e+n;K(i,t),(new Image).src=t}function oe(e){return W.timer.replace(/\{count\}/,e)}function re(e,n){const i=e?f:"";return le(e)+i+le(n)}function le(e){return void 0===e||null===e?"":e}function ce(e,n){n&&(K(e,n),(new Image).src=n)}!function(){t.addEventListener("click",function(e){e.stopPropagation&&e.stopPropagation(),null!==e.cancelBubble&&(e.cancelBubble=!0),Z(video),V()}),Q(0),function(){const e=[i.loading,i.phoneEntryTitle,i.thanksMsg,i.processingText,i.phoneEntrySubTitle,i.phoneEntrySubmitBtn,i.rewardTextEligible,i.continueBtn,i.eligibleBtn,i.ineligibleTitle,i.ineligibleSubTitle,i.ineligibleBtn,i.errorMsg,i.timer];for(let n=0;n<e.length;n++)"string"==typeof e[n].id&&(e[n].innerHTML=W[e[n].id].replace(/\n/,"<br/>"))}(),i.input.maxLength=18,i.input.onkeydown=function(){G()},i.input.onkeyup=function(){G()},i.input.addEventListener("countrychange",function(){G(),i.input.value=""}),i.input.onkeypress=function(e){let n=e.which?e.which:e.keyCode;return!(n>31&&(n<48||n>57))},Z(i.loadingWrapper),ne(y.impression),ce("custom impression pixel",b),this.checkPhoneNumber=V,this.showPlayer=Q,this.countDown=z}()}(window,document);