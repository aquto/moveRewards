/*! move-rewards 2020-02-13 */

!function(e,i){const n=q("preload"),t=q("video"),o=q("eligibleWrapper"),l=q("errorWrapper"),a=q("ineligibleMessage"),c=i.body,s=q("icon"),r=q("rewardText"),d=q("phoneEntryWrapper"),u=q("eligible"),p=q("ineligible"),f=q("timer"),m=q("rewardTextEligible"),g=q("phoneCheck"),b=i.querySelector("#phone");let v,h;const y=H("cid"),L=H("vu"),T="1"===H("d"),k=H("b");let w,E=!1,C=!1;const P=videojs("player",{controls:!0,autoplay:!1,preload:!0,nativeControlsForTouch:!1,inactivityTimeout:0,disableVideoPlayPauseClick:!0,poster:k||"../assets/images/watch-this-eligible.png",sources:[{type:"video/mp4",src:"../assets/videos/placeholder.mp4"}],plugins:{vastClient:{adTagUrl:L,preferredTech:"html5",adsEnabled:!0}}});P.on("play",function(){I("play"),E&&N(t)}),P.on("timeupdate",function(e){E&&N(t),I("update",this.currentTime()/this.duration()*100)}),T&&(P.on("click",function(e){I("click",e)}),P.on("vast.adClick",function(e){I("vast.adClick",e)})),P.on("vast.adError",function(e){N(a),I("vast.adError",e.error),N(o),E&&N(t),A(l),E=!0}),P.on("vast.contentEnd",function(){I("vast.contentEnd"),N(t),!E&&C&&(A(o),aquto.complete({campaignId:y,callback:function(e){I("complete"),e?(N(n),A(o),s.classList.remove("fa-check-circle","fa-times-circle"),e.eligible?(I("complete success"),s.classList.add("fa-check-circle"),W("success"),r.innerHTML=e.rewardText):(I("complete failure"),a.add,s.classList.toggle("fa-times-circle"),W("fail"),r.innerHTML="Lo sentimos, tu número no aplica para ganar megas en éste momento")):(I("complete invalid response"),s.classList.toggle("fa-times-circle"),W("fail"),r.innerHTML="Lo sentimos, hubo un problema para activar los megas.")}})),C||E||(I("not eligible"),N(t),A(a))});const D=e.intlTelInput(b,{allowDropdown:!0,formatOnDisplay:!0,initialCountry:"mx",nationalMode:!1,onlyCountries:["mx","pe"],separateDialCode:!0});let M=5;const x=function(){event&&event.preventDefault();const e=D.getNumber().replace("+","");A(h=q("loadingOverlay")),h.addEventListener("click",function(e){e.stopPropagation&&e.stopPropagation(),null!==e.cancelBubble&&(e.cancelBubble=!0)}),aquto.checkAppEligibility({campaignId:y,phoneNumber:e,callback:function(i){I("checkAppEligibility"),N(h),i?(N(v),i.identified?(i.eligible?(C=!0,e?(I("phone entered eligible"),M=5,A(u),N(g),m.innerHTML=i.rewardText):(I("identified & eligible"),N(n),A(t),P.play())):(C=!1,e?(I("phone entered ineligible"),M=5,A(p),N(g)):(I("identified + ineligible"),M=10,N(n),N(t),A(d),N(g),A(p),A(f),O())),e&&(f.classList.remove("hide"),O())):e?(I("phone entered unidentified"),M=10,C=!1,A(p),N(g),A(f),O()):(I("unidentified"),C=!1,N(n),N(t),A(d))):(I("error.checkAppEligibility"),N(n),N(t),A(l))}})};const B=function(e){event&&event.preventDefault(),w&&(clearTimeout(w),w=null,I("countdown stopped")),N(d),N(o),A(t),0!==e&&P.play()};function H(i){let n,t,o=e.location.search.substring(1).split("&");for(t=0;t<o.length;t++)if((n=o[t].split("="))[0]===i)return void 0===n[1]||decodeURIComponent(n[1])}function I(e,i){T&&console.log(e,i)}function q(e){return i.getElementById(e)}function A(e){e&&e.classList.remove("hide")}function N(e){e&&e.classList.add("hide")}function O(){w=setTimeout("countDown()",1e3)}function W(e){"success"===e&&(c.classList.remove("fail"),c.classList.add(e)),"fail"===e&&(c.classList.remove("success"),c.classList.add(e))}e.onload=function(){N(n),(v=q("videoOverlay")).addEventListener("click",function(e){e.stopPropagation&&e.stopPropagation(),null!==e.cancelBubble&&(e.cancelBubble=!0),N(t),x()}),B(0)},this.checkPhoneNumber=x,this.showPlayer=B,this.countDown=function(){const e=q("timer");M>0?(M--,e.innerHTML="Ver el video en "+M+" segundos.",O()):B(!0)}}(window,document);