/*! move-rewards 2020-01-19 */

!function(e,i){const t=M("preload"),s=M("video"),n=M("eligibleWrapper"),a=M("errorWrapper"),l=M("ineligibleMessage"),o=i.body,c=M("icon"),d=M("rewardText"),r=M("phoneEntryWrapper"),p=M("eligible"),h=M("ineligible"),m=M("timer"),u=M("rewardTextEligible"),g=M("phoneCheck"),L=i.querySelector("#phone");let v=D("cid");D("vu");const f="1"===D("d");let b=!1,y=!1;let T=videojs("player",{controls:!0,autoplay:!1,preload:!0,nativeControlsForTouch:!1,inactivityTimeout:0,poster:"../assets/images/watch-this-ineligible.png",sources:[{type:"video/mp4",src:"../assets/videos/placeholder.mp4"}],plugins:{vastClient:{adTagUrl:"test-01.xml",preferredTech:"html5",adsEnabled:!0}}});f&&(T.on("play",function(){x("play")}),T.on("timeupdate",function(e){x("update",this.currentTime()/this.duration()*100)}),T.on("click",function(e){x("click",e)}),T.on("vast.adClick",function(e){x("vast.adClick",e)})),T.on("vast.adError",function(e){l.classList.add("hide"),x("vast.adError",e.error),n.classList.add("hide"),a.classList.remove("hide"),b=!0}),T.on("vast.contentEnd",function(){x("vast.contentEnd"),s.classList.add("hide"),!b&&y&&(n.classList.remove("hide"),aquto.complete({campaignId:v,callback:function(e){x("complete"),e?(t.classList.add("hide"),n.classList.remove("hide"),c.classList.remove("fa-check-circle","fa-times-circle"),e.eligible?(x("complete success"),c.classList.add("fa-check-circle"),o.classList.toggle("success"),d.innerHTML=e.rewardText):(x("complete failure"),l.add,c.classList.toggle("fa-times-circle"),o.classList.toggle("fail"),d.innerHTML="Lo sentimos, tu número no aplica para ganar megas en éste momento")):(x("complete invalid response"),c.classList.toggle("fa-times-circle"),o.classList.toggle("fail"),d.innerHTML="Lo sentimos, hubo un problema para activar los megas.")}})),y||b||(x("not eligible"),l.classList.remove("hide"))});const w=e.intlTelInput(L,{allowDropdown:!0,formatOnDisplay:!0,initialCountry:"mx",nationalMode:!1,onlyCountries:["mx","pe"],separateDialCode:!0});let k=5;const E=function(){event&&event.preventDefault();const i=w.getNumber().replace("+","");aquto.checkAppEligibility({campaignId:v,phoneNumber:i,callback:function(n){x("checkAppEligibility"),n?n.identified?(n.eligible?(y=!0,i?(x("phone entered eligible"),k=5,p.classList.remove("hide"),g.classList.add("hide"),u.innerHTML=n.rewardText):(x("identified & eligible"),T.poster("../assets/images/watch-this-eligible.png"),t.classList.add("hide"),s.classList.remove("hide"))):(y=!1,i?(x("phone entered ineligible"),k=10,h.classList.remove("hide"),g.classList.add("hide")):(x("identified + ineligible"),t.classList.add("hide"),function(){try{const i=e.parent.document.getElementById("aq_iframe");i.parentNode.removeChild(i)}catch(e){}}())),i&&(m.classList.remove("hide"),setTimeout("countDown()",1e3))):i&&"ineligiblenet"===n.status?(x("phone entered unidentified"),k=10,y=!1,h.classList.remove("hide"),g.classList.add("hide"),m.classList.remove("hide"),setTimeout("countDown()",1e3)):(x("unidentified"),y=!1,t.classList.add("hide"),r.classList.remove("hide")):(x("error.checkAppEligibility"),t.classList.add("hide"),a.classList.remove("hide"))}})};const C=function(){event&&event.preventDefault(),r.classList.add("hide"),n.classList.add("hide"),s.classList.remove("hide"),T.play()};function D(i){let t,s,n=e.location.search.substring(1).split("&");for(s=0;s<n.length;s++)if((t=n[s].split("="))[0]===i)return void 0===t[1]||decodeURIComponent(t[1])}function x(e,i){f&&console.log(e,i)}function M(e){return i.getElementById(e)}e.onload=function(){E()},this.checkPhoneNumber=E,this.showPlayer=C,this.countDown=function(){let e=M("timer");k>0?(k--,e.innerHTML="Ver el video en "+k+" segundos.",setTimeout("countDown()",1e3)):(y?T.poster("../assets/images/watch-this-eligible.png"):T.poster("../assets/images/watch-this-ineligible.png"),C())}}(window,document);